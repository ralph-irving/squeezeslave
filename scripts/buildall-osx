#!/bin/bash
SQC="`dirname $0`/../src/squeezeslave/squeezeslave.c"
VER=`grep version\ = ${SQC} | awk -F\" '{print \$2}'`
REV=`svnversion`

make -f makefile.osx-i64-display realclean
make -f makefile.osx-intel-display realclean

make -f makefile.osx-ppc-display realclean
make -f makefile.osx-ppc-display

mv bin/squeezeslave bin/squeezeslave-ppc-$VER-$REV

make -f makefile.osx-ppc-display realclean

make -f makefile.osx-intel-display realclean
make -f makefile.osx-intel-display

mv bin/squeezeslave bin/squeezeslave-intel-$VER-$REV

make -f makefile.osx-intel-display realclean

make -f makefile.osx-i64-display realclean
make -f makefile.osx-i64-display

mv bin/squeezeslave bin/squeezeslave-i64-$VER-$REV

cd bin && lipo -create squeezeslave-ppc-$VER-$REV squeezeslave-intel-$VER-$REV squeezeslave-i64-$VER-$REV -output squeezeslave-$VER-$REV

file bin/squeezeslave-$VER-$REV
